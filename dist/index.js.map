{"version":3,"file":"index.js","sources":["../src/tools/Tools.js","../src/providers/ABCProvider.js","../src/interceptors/Interceptors.js"],"sourcesContent":["import URL from \"url-parse\";\r\n\r\nfunction mapUrls(url, urlMappings) {\r\n    if (urlMappings[url]) {\r\n        return urlMappings[url];\r\n    }\r\n    return url;\r\n}\r\n\r\nfunction addQuarantineSegmentToUrl(originalUrl, quarantineSegment = \"\") {\r\n    if (quarantineSegment === \"\") return originalUrl;\r\n\r\n    // Parse the original URL\r\n    const url = new URL(originalUrl);\r\n\r\n    // Insert the quarantine segment after the domain in the pathname\r\n    url.pathname = `/${quarantineSegment}${url?.pathname}`;\r\n    // Get the modified URL\r\n    const modifiedUrl = url.toString();\r\n\r\n    return modifiedUrl;\r\n}\r\n\r\nfunction mergeHeaders(originalHeaders = {}, newHeaders = {}) {\r\n    // Get the modified headers\r\n    const modifiedHeaders = merge(originalHeaders, newHeaders);\r\n    return modifiedHeaders;\r\n}\r\n\r\nfunction mergeDeep(target, source) {\r\n    for (let key in source) {\r\n        // If both target and source have the same key, and their values are objects, merge them recursively\r\n        if (source[key] instanceof Object && key in target) {\r\n            Object.assign(source[key], mergeDeep(target[key], source[key]));\r\n        }\r\n    }\r\n    // Merge source into target\r\n    return Object.assign(target || {}, source);\r\n}\r\n\r\nfunction groupByPrefixAndStructureV1(data) {\r\n    let grouped = {};\r\n\r\n    for (const key in data) {\r\n        if (data.hasOwnProperty(key)) {\r\n            const parts = key.split(\"-\");\r\n            const prefix = parts[0];\r\n            const valueObject = data[key];\r\n\r\n            if (!grouped[prefix]) {\r\n                grouped[prefix] = {};\r\n            }\r\n\r\n            if (prefix === \"api\") {\r\n                const defaultValue = valueObject.defaultValue;\r\n                const result = valueObject.result;\r\n                // Use \"defaultValue\" as key and \"result\" as value for \"api\" prefix\r\n                grouped[prefix][defaultValue] = result;\r\n            } else if (prefix === \"response\") {\r\n                const result = valueObject.result;\r\n\r\n                grouped[prefix] = {\r\n                    ...grouped[prefix],\r\n                    ...result,\r\n                };\r\n            } else if (prefix === \"context\") {\r\n                const result = valueObject.result;\r\n\r\n                grouped = {\r\n                    ...grouped,\r\n                    ...result,\r\n                };\r\n            }\r\n        }\r\n    }\r\n\r\n    return grouped;\r\n}\r\n\r\nfunction groupByPrefixAndStructure(data) {\r\n\r\n    console.log(\"this data: \", JSON.stringify(data, null, 0));\r\n    \r\n    let grouped = {};\r\n\r\n    for (const key in data) {\r\n        if (data.hasOwnProperty(key)) {\r\n            const parts = key.split(\"-\");\r\n            const prefix = parts[0];\r\n            const valueObject = data[key];\r\n\r\n            if (!grouped[prefix]) {\r\n                grouped[prefix] = {};\r\n            }\r\n\r\n            const defaultValue = valueObject.defaultValue;\r\n            const result = valueObject.result;\r\n\r\n            if (prefix === \"api\") {\r\n                // Use \"defaultValue\" as key and \"result\" as value for \"api\" prefix\r\n                grouped[prefix][defaultValue] = result;\r\n            } else if (prefix === \"response\" || prefix === \"navigation\") {\r\n                grouped[prefix] = {\r\n                    ...grouped[prefix],\r\n                    ...result,\r\n                };\r\n            } else if (prefix === \"context\") {\r\n                grouped[prefix] = mergeDeep(grouped[prefix], result)\r\n            }\r\n        }\r\n    }\r\n\r\n    return grouped;\r\n}\r\n\r\nexport {\r\n    mergeHeaders,\r\n    addQuarantineSegmentToUrl,\r\n    groupByPrefixAndStructure,\r\n    mapUrls\r\n}","import React, {\r\n  useEffect,\r\n  useState,\r\n  useMemo,\r\n  Children,\r\n  cloneElement\r\n} from \"react\";\r\n\r\nimport {\r\n  GrowthBook,\r\n  GrowthBookProvider,\r\n} from \"@growthbook/growthbook-react\";\r\n\r\nimport {\r\n  groupByPrefixAndStructure\r\n} from \"../tools\"\r\n\r\nconst ABCProvider = ({\r\n  children,\r\n  getModel,\r\n  updateModel,\r\n  model,\r\n  analytic,\r\n  debug = false,\r\n  event: {\r\n    eventType = \"view_screen\",\r\n    eventName = \"screen_name\",\r\n    eventValue = \"abc-platform\"\r\n  } = {}\r\n}) => {\r\n  const {\r\n    misc: {\r\n      abcTesting: {\r\n        iamABCTester = false,\r\n        abcScope = 888888,\r\n        abcEndpoint,\r\n        // abcEnable,\r\n        abcSdk,\r\n        abcTimeout = 30000,\r\n        abcDefaultAttributes = {}\r\n      } = {}\r\n    },\r\n  } = getModel([\"misc\"]);\r\n\r\n  const [isReady, setIsReady] = useState(\"FALSE\");\r\n\r\n  const arrayChildren = Children.toArray(children);\r\n\r\n  const gb = useMemo(\r\n    () => {\r\n      if (iamABCTester && model?.misc?.abcTesting?.abcEnable) {\r\n        // console.log(iamABCTester, \"iamABCTesteriamABCTester useMemo\");\r\n        const gb = new GrowthBook({\r\n          apiHost: abcEndpoint,\r\n          clientKey: abcSdk,\r\n          // Enable easier debugging during development\r\n          // enableDevMode: true,\r\n          // Update the instance in realtime as features change in GrowthBook\r\n          // subscribeToChanges: true,\r\n          // Only required for A/B testing\r\n          // Called every time a user is put into an experiment\r\n          trackingCallback: (experiment, result) => {\r\n            if (analytic && analytic instanceof Function) {\r\n              try {\r\n                console.log(\"[abc] abc-experiment-done\", {\r\n                  experimentId: experiment.key,\r\n                  variationId: result.key,\r\n                });\r\n                analytic(\"abc-experiment-done\", {\r\n                  experimentId: experiment?.key,\r\n                  variationId: result?.key,\r\n                });\r\n              } catch (error) {\r\n                if (debug) {\r\n                  console.log('[abc]', error);\r\n                }\r\n              }\r\n            }\r\n            \r\n          },\r\n          // onFeatureUsage: (featureKey, result) => {\r\n          //   console.log(\"feature\", featureKey, \"has value\", result.value);\r\n          // },\r\n        });\r\n        return gb;\r\n      }\r\n    },\r\n    [abcEndpoint, iamABCTester]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (model?.misc?.abcTesting?.iamABCTester && model?.misc?.abcTesting?.abcEnable) {\r\n      if (analytic && analytic instanceof Function) {\r\n        try {\r\n          analytic(eventType, {\r\n            [eventName]: eventValue\r\n          });\r\n        } catch (error) {\r\n          if (debug) {\r\n            console.log('[abc]', error);\r\n          }\r\n        }\r\n      }\r\n\r\n      gb.init({\r\n        timeout: abcTimeout,\r\n      }).then(() => {\r\n        setIsReady(Date.now());\r\n      });\r\n      gb.setAttributes({\r\n        ...abcDefaultAttributes,\r\n        ...(model?.user && model.user || {}),\r\n        ...(model?.cohort && model?.cohort || {}),\r\n        scope: abcScope\r\n      });\r\n    }\r\n  }, [model?.misc?.abcTesting?.abcEnable, model?.misc?.abcTesting?.iamABCTester, model?.user, model?.cohort]);\r\n\r\n  const evaluateFeatures = () => {\r\n    if (iamABCTester && model?.misc?.abcTesting?.abcEnable) {\r\n\r\n      try {\r\n        const allFeatures = gb.getFeatures();\r\n\r\n        let done = {};\r\n        Object.keys(allFeatures).map((key) => {\r\n          const result = gb.getFeatureValue(key, allFeatures[key].defaultValue);\r\n          done[key] = {\r\n            defaultValue: allFeatures[key].defaultValue,\r\n            result,\r\n          };\r\n        });\r\n\r\n        // Call the function to group by prefix\r\n        const groupedData = groupByPrefixAndStructure(done);\r\n\r\n        updateModel({ ...groupedData });\r\n      } catch (error) {\r\n        if (debug) {\r\n          console.log('[abc]', error);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Boolean(isReady === \"FALSE\")) {\r\n      return;\r\n    }\r\n\r\n    evaluateFeatures();\r\n  }, [isReady, model?.misc?.abcTesting?.iamABCTester]);\r\n\r\n  return (\r\n    <GrowthBookProvider growthbook={gb}>\r\n      {Children.map(arrayChildren, (child) => {\r\n        return cloneElement(child, {});\r\n      })}\r\n    </GrowthBookProvider>\r\n  );\r\n};\r\n\r\nexport default ABCProvider;","import { merge } from \"lodash\";\r\n\r\nimport {\r\n    addQuarantineSegmentToUrl,\r\n    mapUrls\r\n} from \"../tools\"\r\n\r\nfunction responseInterceptor({ getModel, response, debug = false }) {\r\n    // Modify the response data here mapUrls\r\n    try {\r\n        const dictionary = getModel([\"response\"])?.response || {};\r\n        const responseUrl = response.config.url;\r\n\r\n        response = merge(response, mapUrls(responseUrl, dictionary));\r\n        if (debug) {\r\n            console.log(\"[responseInterceptor] Request URL:\", responseUrl);\r\n            console.log(\"[responseInterceptor] context\", getModel([\"response\"])?.response);\r\n            console.log(\"[responseInterceptor] data\", response?.data);\r\n        }\r\n        return response;\r\n    } catch (error) {\r\n        if (debug) {\r\n            console.log('[responseInterceptor]', error)\r\n        }\r\n        return response\r\n    }\r\n}\r\nfunction requestInterceptor({ getModel, request, debug = false }) {\r\n    // Modify the response data here mapUrls\r\n    try {\r\n        const dictionary = getModel([\"api\"])?.api || {};\r\n        const requests = getModel(\"requests\") || {\r\n            //to check whether \r\n            //requires merging the header for request or not\r\n            enabled: false,\r\n            headers: {},\r\n            //the prefix to be merged with endpoint path\r\n            //example: www.domain.com/prefix/api/example\r\n            prefix: \"\",\r\n        };\r\n\r\n        //to replace the url with alternative from abc\r\n        request.url = mapUrls(request.url, dictionary);\r\n        if (requests.enabled) {\r\n            //merge prefix with url\r\n            request.url = addQuarantineSegmentToUrl(request.url, requests.prefix);\r\n        }\r\n        if (debug) {\r\n            console.log(\r\n                requests,\r\n                request?.headers,\r\n                requests?.enabled,\r\n                request?.url,\r\n                \"[requestInterceptor] details\"\r\n            );\r\n        }\r\n        return request;\r\n    } catch (error) {\r\n        if (debug) {\r\n            console.log('[requestInterceptor] error:', error)\r\n        }\r\n        return request\r\n    }\r\n}\r\n\r\nexport {\r\n    requestInterceptor,\r\n    responseInterceptor\r\n}"],"names":["mapUrls","url","urlMappings","addQuarantineSegmentToUrl","originalUrl","quarantineSegment","URL","pathname","modifiedUrl","toString","mergeDeep","target","source","key","Object","assign","groupByPrefixAndStructure","data","console","log","JSON","stringify","grouped","hasOwnProperty","parts","split","prefix","valueObject","defaultValue","result","_extends","ABCProvider","_ref","_model$misc4","_model$misc5","_model$misc7","children","getModel","updateModel","model","analytic","_ref$debug","debug","_ref$event","event","_ref$event2","_ref$event2$eventType","eventType","_ref$event2$eventName","eventName","_ref$event2$eventValu","eventValue","_getModel","_getModel$misc$abcTes","misc","abcTesting","_getModel$misc$abcTes2","_getModel$misc$abcTes3","iamABCTester","_getModel$misc$abcTes4","abcScope","abcEndpoint","abcSdk","_getModel$misc$abcTes5","abcTimeout","_getModel$misc$abcTes6","abcDefaultAttributes","_useState","useState","isReady","setIsReady","arrayChildren","Children","toArray","gb","useMemo","_model$misc","abcEnable","GrowthBook","apiHost","clientKey","trackingCallback","experiment","Function","experimentId","variationId","error","useEffect","_model$misc2","_model$misc3","_analytic","init","timeout","then","Date","now","setAttributes","user","cohort","scope","evaluateFeatures","_model$misc6","allFeatures","getFeatures","done","keys","map","getFeatureValue","groupedData","Boolean","React","createElement","GrowthBookProvider","growthbook","child","cloneElement","responseInterceptor","response","dictionary","responseUrl","config","merge","_getModel2","_response","requestInterceptor","_ref2","request","_ref2$debug","_getModel3","api","requests","enabled","headers"],"mappings":"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"}